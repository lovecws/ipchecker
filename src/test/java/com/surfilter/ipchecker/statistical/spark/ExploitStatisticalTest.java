package com.surfilter.ipchecker.statistical.spark;

import com.surfilter.ipchecker.statistical.spark.ExploitStatistical;
import org.junit.Test;

public class ExploitStatisticalTest {

    @Test
    public void statistical() {
        String filePath = System.getProperty("user.dir").replace("\\", "/") + "/event/jiangxi/20180620110434";
        String ipUnitModelPath = filePath + "/ipunit_model.json";//根据ipstr匹配ip单位
        String statisticalPath = filePath + "/exploit_statistical.txt";//统计结果

        //不区分IOT ICS统计
        ExploitStatistical exploitStatistical = new ExploitStatistical(null, null);
        exploitStatistical.statistical(ipUnitModelPath, statisticalPath);
        //iot 物联统计
        ExploitStatistical IOTExploitStatistical = new ExploitStatistical("device.primary_type", "IOT");
        IOTExploitStatistical.statistical(ipUnitModelPath, statisticalPath);
        //ICS 工控统计
        ExploitStatistical ICSexploitStatistical = new ExploitStatistical("device.primary_type", "ICS");
        ICSexploitStatistical.statistical(ipUnitModelPath, statisticalPath);
    }
}
